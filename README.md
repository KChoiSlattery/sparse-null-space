# python-sparse-null

Python implementation of sparse null-space algorithm.

`sparse_null(A)` creates a sparse array whose columns span the null space of $A$, based on [^1] and its MATLAB implementation in [^2]. The output is much more sparse than a corresponding null space generated with QR or SVD factorization, and is faster for large and sparse inputs. Unlike the null space generated by `scipy.linalg.null_space`, the output is generally not orthogonal.

## Example Usage

```python
from scipy import sparse
from sparse_null import sparse_null

A = sparse.random_array((1000, 15000), density=0.001, rng=12)
H = sparse_null(A, show=True) # show=True enables a progress bar

# Verify that each column of H produces 0 when multiplied into A, should be 8.9e-16
print((A @ H).max())
```

## Performance Comparisons

### Runtime

| $A$ shape     | $A$ density | `sparse_null` | `scipy.linalg.null_space` |
| ------------- | ----------- | ------------- | ------------------------- |
| (3000, 3000)  | 0.1%        | 2.1 s         | 4.2 s                     |
| (3000, 3000)  | 0.01%       | 724 ms        | 3.3 s                     |
| (3000, 15000) | 0.1%        | 6.2 s         | 28.8 s                    |
| (100, 15000)  | 0.1%        | 78.3 ms       | 18.5 s                    |

### Density of Null Space

The density is defined as the number of nonzero elements divided by the total number of
elements in the array. 

| $A$ shape     | $A$ density | `sparse_null` | `scipy.linalg.null_space` |
|---------------|-------------|---------------|---------------------------|
| (3000, 3000)  | 0.1%        | 0.053%        | 99.8%                     |
| (3000, 3000)  | 0.01%       | 0.034%        | 55.3%                     |
| (3000, 15000) | 0.1%        | 0.28%         | 91.5%                     |
| (100, 15000)  | 0.1%        | 0.0073%       | 0.26%                     |

[^1]: M. Khorramizadeh and N. Mahdavi-Amiri, "An efficient algorithm for sparse null
space basis problem using ABS methods," Numerical Algorithms, vol. 62, no. 3, pp.
469â€“485, Jun. 2012.

[^2]: Martin Holters (2024). Null space for sparse matrix
(https://www.mathworks.com/matlabcentral/fileexchange/42922-null-space-for-sparse-matrix),
MATLAB Central File Exchange. Retrieved December 19, 2024.